<!DOCTYPE html><html lang="zh-CN" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Video in Unity | ZeroUltra</title><meta name="author" content="Roger"><meta name="copyright" content="Roger"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="视频概念 硬解码:通过硬件(GPU)来解码视频,优点是效率高,降低功耗,缺点支持格式少  软解码:利用CPU来解码视频  **帧率:**视频是由于一幅幅图组合而成,帧率越高,表现的越丝滑  **码率:**也叫比特率,是一定时间内传输多少比特(bit)。计算方法：如一帧图大小是0.8kb，那么码率30帧就是0.8kbx8(一个byte有8bit)&#x3D;6.4kbx30&#x3D; 192 kb">
<meta property="og:type" content="article">
<meta property="og:title" content="Video in Unity">
<meta property="og:url" content="https://zeroultra.github.io/2020/01-28-2020-1-28-Video-in-Unity/index.html">
<meta property="og:site_name" content="ZeroUltra">
<meta property="og:description" content="视频概念 硬解码:通过硬件(GPU)来解码视频,优点是效率高,降低功耗,缺点支持格式少  软解码:利用CPU来解码视频  **帧率:**视频是由于一幅幅图组合而成,帧率越高,表现的越丝滑  **码率:**也叫比特率,是一定时间内传输多少比特(bit)。计算方法：如一帧图大小是0.8kb，那么码率30帧就是0.8kbx8(一个byte有8bit)&#x3D;6.4kbx30&#x3D; 192 kb">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://raw.githubusercontent.com/ZeroUltra/MediaLibrary/main/Imgs/202212171811751.png">
<meta property="article:published_time" content="2020-01-28T04:41:54.000Z">
<meta property="article:modified_time" content="2020-01-28T04:41:54.000Z">
<meta property="article:author" content="Roger">
<meta property="article:tag" content="Unity">
<meta property="article:tag" content="视频">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/ZeroUltra/MediaLibrary/main/Imgs/202212171811751.png"><link rel="shortcut icon" href="/img/favicon.jpg"><link rel="canonical" href="https://zeroultra.github.io/2020/01-28-2020-1-28-Video-in-Unity/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Video in Unity',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2020-01-28 12:41:54'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.0.0"><link rel="alternate" href="/atom.xml" title="ZeroUltra" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/headicon.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">35</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">32</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">18</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/aboutme/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg fixed" id="page-header" style="background-image: url('https://raw.githubusercontent.com/ZeroUltra/MediaLibrary/main/Imgs/202212171811751.png')"><nav id="nav"><span id="blog-info"><a href="/" title="ZeroUltra"></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/aboutme/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Video in Unity</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-01-28T04:41:54.000Z" title="发表于 2020-01-28 12:41:54">2020-01-28</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2020-01-28T04:41:54.000Z" title="更新于 2020-01-28 12:41:54">2020-01-28</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Unity/">Unity</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Unity/%E4%BC%98%E5%8C%96/">优化</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Video in Unity"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="视频概念"><a href="#视频概念" class="headerlink" title="视频概念"></a>视频概念</h1><ul>
<li><p><strong>硬解码</strong>:通过硬件(GPU)来解码视频,优点是效率高,降低功耗,缺点支持格式少</p>
</li>
<li><p><strong>软解码</strong>:利用CPU来解码视频</p>
</li>
<li><p>**帧率:**视频是由于一幅幅图组合而成,帧率越高,表现的越丝滑</p>
</li>
<li><p>**码率:**也叫比特率,是一定时间内传输多少比特(bit)。计算方法：如一帧图大小是0.8kb，那么码率30帧就是0.8kbx8(一个byte有8bit)&#x3D;6.4kbx30&#x3D; 192 kb&#x2F;s</p>
</li>
</ul>
<p>推荐一个视频解码器：<a target="_blank" rel="noopener" href="https://www.codecguide.com/download_kl.htm">下载 K-Lite 编解码器包 (codecguide.com)</a></p>
<p>或者直接下载potPlayer和VLN软件也会自带一些解码器</p>
<p>Unity中播放视频;</p>
<ul>
<li>VideoPlayer</li>
<li>AVPro插件</li>
<li><a target="_blank" rel="noopener" href="https://www.criware.cn/web/#/zh/home/index">CRIWARE中国官网网站</a></li>
</ul>
<h1 id="Unity视频视频格式问题"><a href="#Unity视频视频格式问题" class="headerlink" title="Unity视频视频格式问题"></a>Unity视频视频格式问题</h1><p>在unity中采用VideoPlayer播放视频会有很多日志警告</p>
<p>这里采用<a target="_blank" rel="noopener" href="https://handbrake.fr/">HandBrake</a>软件对视频进行编码</p>
<h3 id="Unexpected-timestamp-values-detected-This-can-occur-in-H-264-videos-not-encoded-with-the-baseline-profile…"><a href="#Unexpected-timestamp-values-detected-This-can-occur-in-H-264-videos-not-encoded-with-the-baseline-profile…" class="headerlink" title="Unexpected timestamp values detected. This can occur in H.264 videos not encoded with the baseline profile…"></a>Unexpected timestamp values detected. This can occur in H.264 videos not encoded with the baseline profile…</h3><p>​	将视频进行baseline编码</p>
<p> <img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/ZeroUltra/MediaLibrary/main/Imgs/202405181839634.png" alt="image-20240518183940431"></p>
<p>参考:<a target="_blank" rel="noopener" href="https://forum.unity.com/threads/audiosampleprovider-buffer-overflow-xxx-frames-discarded.844042/"><a target="_blank" rel="noopener" href="https://forum.unity.com/threads/uwp-hololens-2-app-crash-after-some-seconds-when-reading-video.1405990/">Bug - UWP HoloLens 2 App Crash after some seconds when reading video - Unity Forum</a></a></p>
<blockquote>
<p>Is it only happening in the build and not on the Desktop? Can you try transcoding your file in baseline? I see it is <a href="mailto:&#72;&#105;&#103;&#104;&#64;&#x4c;&#x34;&#46;&#x32;">&#72;&#105;&#103;&#104;&#64;&#x4c;&#x34;&#46;&#x32;</a>. You can do that using FFmpeg or the software you used to encode your file.</p>
<p>Code (CSharp):</p>
<ol>
<li>ffmpeg -i input.mp4 -c:v libx264 -preset fast -profile:v baseline <strong>out</strong>.mp4</li>
</ol>
</blockquote>
<h3 id="First-video-frame-not-zero-2-0-083333s-Result-may-be-out-of-sync…"><a href="#First-video-frame-not-zero-2-0-083333s-Result-may-be-out-of-sync…" class="headerlink" title="First video frame not zero: 2 (0.083333s). Result may be out of sync…."></a>First video frame not zero: 2 (0.083333s). Result may be out of sync….</h3><p>​	开始帧没对齐 用视频重新转一下就ok</p>
<h3 id="WindowsVideoMedia-error-unhandled-Color-Standard-0-falling-back-to-default-this-may-result-in-rendering-issues"><a href="#WindowsVideoMedia-error-unhandled-Color-Standard-0-falling-back-to-default-this-may-result-in-rendering-issues" class="headerlink" title="WindowsVideoMedia error unhandled Color Standard: 0 falling back to default this may result in rendering issues"></a>WindowsVideoMedia error unhandled Color Standard: 0 falling back to default this may result in rendering issues</h3><p>​	参考:<a target="_blank" rel="noopener" href="https://forum.unity.com/threads/null-reference-exception-when-playing-video.1243489/">Video - Null Reference Exception when playing video - Unity Forum</a></p>
<p>​	<a target="_blank" rel="noopener" href="https://forum.unity.com/threads/video-file-problem.1428865/">Question - Video file problem - Unity Forum</a></p>
<blockquote>
<p>Yeah, the “Unexpected timestamp values detected” warning tells you that we have to offset the video timestamps, and frame accuracy will be impacted negatively because it was not encoded using the baseline profile. For most users, it is not an issue. But if you care, you should encode your file using the baseline profile.</p>
<p>The “WindowsVideoMedia error unhandled color standard: 0” warn that the video file doesn’t specify its color standard and we took a guess and chose BT.709 as it is the most popular. In Unity, we support <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Rec._601">BT.601</a>, <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Rec._709">BT.709</a>, and <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Rec._2020">BT.2020</a>. Again for most users, it is not an issue. But if you care or see a color shift because your file is not BT.709, you should specify the color standard while encoding your video files.</p>
</blockquote>
<p> 将色彩空间修改成 <code>BT601 BT701 BT2020</code> 即可</p>
<p>​	<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/ZeroUltra/MediaLibrary/main/Imgs/202405181858722.png" alt="image-20240518185802207"></p>
<h3 id="AudioSampleProvider-buffer-overflow-XXX-frames-discarded"><a href="#AudioSampleProvider-buffer-overflow-XXX-frames-discarded" class="headerlink" title="AudioSampleProvider buffer overflow. XXX frames discarded"></a>AudioSampleProvider buffer overflow. XXX frames discarded</h3><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/wodownload2/article/details/124503621">AudioSampleProvider buffer overflow_skip on drop-CSDN博客</a></p>
<h1 id="播放透明视频"><a href="#播放透明视频" class="headerlink" title="播放透明视频"></a>播放透明视频</h1><p>在unity中呈现透明视频播放主要有一下几种方式:</p>
<ol>
<li>利用Unity自带的<code>VideoPlayer</code> 播放透明视频</li>
<li>利用<code>AVpro插件</code>播放格式为<code>Hap alpha</code>或者<code>Hap Q alpha</code> 的<code>.mov</code>或<code>.avi</code></li>
<li>利用<code>Avpro</code>播放通道分离的<code>.MP4</code> 视频</li>
<li>利用shader 分离进行透明分离(暂不讨论)</li>
</ol>
<p>本文最后会介绍一个自己做的小工具用于转换透明视频</p>
<h2 id="利用Unity自带的VideoPlayer组件播放透明视频"><a href="#利用Unity自带的VideoPlayer组件播放透明视频" class="headerlink" title="利用Unity自带的VideoPlayer组件播放透明视频"></a>利用Unity自带的VideoPlayer组件播放透明视频</h2><p>​	unity在5.6版本增加了播放视频的的功能,对应的就是VideoPlayer组件. 在Unity中暂时支持两种透明格式的视频,<a target="_blank" rel="noopener" href="https://docs.unity3d.com/Manual/VideoTransparency.html">链接说明</a></p>
<ol>
<li><code>.webm</code> 是Google基于 以 Matroska（就是我们熟知的 <a target="_blank" rel="noopener" href="https://baike.baidu.com/item/MKV">MKV</a>）容器格式为基础开发的新容器格式，里面包括了 VP8 视频和 Ogg Vorbis 音轨 .</li>
<li><code>apple prores 4444</code> 视频格式,此格式不太熟,具体看官方说明 ,附上一个apple prores 4444 <a target="_blank" rel="noopener" href="https://support.apple.com/en-gb/HT202410">视频说明</a></li>
</ol>
<p>将导入的.webm视频放入unity中查看</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/ZeroUltra/MediaLibrary/main/Imgs/202206162157815.gif"></p>
<p>如上,那么这个视频就是支持透明通道了 接着只要按照寻常的方法用VideoPlayer组件对其进行播放即可</p>
<h3 id="制作webm视频"><a href="#制作webm视频" class="headerlink" title="制作webm视频"></a>制作webm视频</h3><p>一般在pr或者 Media Encoder 中制作视频导出的时候 没有是webm格式,这个时候就需要下载插件,<a target="_blank" rel="noopener" href="https://www.fnordware.com/WebM/">插件链接</a></p>
<p>导出的时候(搬图)</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/ZeroUltra/MediaLibrary/main/Imgs/202206162157975.png"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/ZeroUltra/MediaLibrary/main/Imgs/202206162158674.png"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/ZeroUltra/MediaLibrary/main/Imgs/202206162158843.png"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/ZeroUltra/MediaLibrary/main/Imgs/202206162158212.png"></p>
<p><strong>注意:</strong> 一般webm视频 我们不需要其他的一些操作就可以支持透明视频,在android平台上面 需要一些操作</p>
<p>在官方文档中也有说明：<a target="_blank" rel="noopener" href="https://docs.unity.cn/cn/2019.4/Manual/VideoSources-FileCompatibility.html">视频文件兼容性 - Unity 手册</a></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/ZeroUltra/MediaLibrary/main/Imgs/202310232206237.png" alt="img"></p>
<h3 id="Webm-与-VP8"><a href="#Webm-与-VP8" class="headerlink" title="Webm 与 VP8"></a>Webm 与 VP8</h3><blockquote>
<p>.webm 文件格式对规范进行了改进，因此可在与 VP8 视频编解码器结合使用时携带原生的 Alpha 信息。这意味着任何 Editor 平台都可以读取使用这种透明度格式的视频。由于 Unity 支持的大多数平台都使用软件实现方案来解码这些文件，因此不需要为这些平台进行转码。一个需要注意的例外情况是 Android。该平台的原生 VP8 支持中不包括透明度支持，这意味着必须启用转码，以便 Unity 使用其内部 Alpha 表示方法也就是我们要手动对其进行转码</p>
</blockquote>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/ZeroUltra/MediaLibrary/main/Imgs/202206162158097.jpg"></p>
<h2 id="利用Avpro-播放编码格式为Hap-alpha或者Hap-Q-alpha-的-mov或-avi"><a href="#利用Avpro-播放编码格式为Hap-alpha或者Hap-Q-alpha-的-mov或-avi" class="headerlink" title="利用Avpro 播放编码格式为Hap alpha或者Hap Q alpha 的.mov或.avi"></a>利用Avpro 播放编码格式为Hap alpha或者Hap Q alpha 的.mov或.avi</h2><p><code>hap codec</code>格式支持Windows和mac os x平台 ,并且有以下几处优点:</p>
<ul>
<li>CPU使用率极低</li>
<li>GPU解压缩</li>
<li>内存使用率低</li>
<li>支持非常高分辨率</li>
<li>支持alpha通道透明</li>
</ul>
<p>缺点:</p>
<ul>
<li>文件过大</li>
</ul>
<p>Avpro支持AVI 和MOV  但是更加推荐Mov.</p>
<p>hap codec 有至少四种编码<code> hap</code> <code>hap alpha</code> <code> hapq</code>(高质量) <code>hapq alpha </code></p>
<p>然后在 AvPro中选择 DirectShow</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/ZeroUltra/MediaLibrary/main/Imgs/202206162158134.jpg"></p>
<h3 id="导出mov文件"><a href="#导出mov文件" class="headerlink" title="导出mov文件"></a>导出mov文件</h3><p>Quick time Hap </p>
<p>导出hap alpha 格式的mov视频可以下载quick time  然后下载编码格式<a target="_blank" rel="noopener" href="https://github.com/disguise-one/hap-encoder-adobe-cc/releases">插件</a></p>
<p>导出的时候设置:</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/ZeroUltra/MediaLibrary/main/Imgs/202206162158359.png"></p>
<h3 id="直接在PR或者Media-Encoder中导出"><a href="#直接在PR或者Media-Encoder中导出" class="headerlink" title="直接在PR或者Media Encoder中导出"></a>直接在PR或者Media Encoder中导出</h3><p>如果觉得麻烦,可以直接在pr中导出hap alpha 编码格式,插件<a target="_blank" rel="noopener" href="https://github.com/disguise-one/hap-encoder-adobe-cc">下载链接</a></p>
<p>然后在pr 或者media encoder 中导出选择hap 编码格式为<code>hap alpha</code> 或者 <code>hap q alpha</code></p>
<h3 id="利用ffmpeg-转换"><a href="#利用ffmpeg-转换" class="headerlink" title="利用ffmpeg 转换"></a>利用ffmpeg 转换</h3><ul>
<li>ffmpeg -i input.mov -vcodec hap -format hap output-hap.mov</li>
<li>ffmpeg -i input.mov -vcodec hap -format hap_alpha output-hap.mov</li>
<li>ffmpeg -i input.mov -vcodec hap -format hap_q output-hap.mov</li>
</ul>
<p>注意:</p>
<ul>
<li>可以添加 <code>-chunks 4</code> 将解码添加到多线程中 加快视频解码过程</li>
<li>视频长宽必须是4的倍数</li>
</ul>
<h2 id="利用AVpro-播放通道分离的mp4视频"><a href="#利用AVpro-播放通道分离的mp4视频" class="headerlink" title="利用AVpro 播放通道分离的mp4视频"></a>利用AVpro 播放通道分离的mp4视频</h2><p>这算是一种通用方法了,几乎平台都支持,唯一的缺点就是会增加视频的分辨率 这将会导致一些播放硬件的不支持</p>
<p>在Avpro的demo场景<code>Demo_Transparency</code> 就有两个透明龙视频 一个是左右分离 一个是上下分离</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/ZeroUltra/MediaLibrary/main/Imgs/202206162158406.jpg"></p>
<p>可以在AE软件中直接制作 也可以直接 用ffmpeg 转换</p>
<p>在用ffmpeg转换中 导出的mov编码要是 rgb+a</p>
<h2 id="透明视频工具"><a href="#透明视频工具" class="headerlink" title="透明视频工具"></a>透明视频工具</h2><p>这是基于FFmpeg 写的视频转换工具 主要就是调用ffmpeg命令</p>
<p>工具我上传到了<a target="_blank" rel="noopener" href="https://github.com/ZeroUltra/UnityAlphaVideo">GitHub</a>  </p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p> <a target="_blank" rel="noopener" href="https://blog.csdn.net/lvcoc/article/details/86303249">https://blog.csdn.net/lvcoc/article/details/86303249</a> </p>
<h1 id="题外话"><a href="#题外话" class="headerlink" title="题外话"></a>题外话</h1><p>2020年的春节注定是难忘的,新型冠状病毒从武汉爆发衍生到全国各地 ,为了隔离病毒,防止蔓延,大多数地方封城,封村.希望全国上下齐心协力战胜这次灾难!!!</p>
<p>​																			————— 在家躺尸n天的我</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://zeroultra.github.io">Roger</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://zeroultra.github.io/2020/01-28-2020-1-28-Video-in-Unity/">https://zeroultra.github.io/2020/01-28-2020-1-28-Video-in-Unity/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://zeroultra.github.io" target="_blank">ZeroUltra</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Unity/">Unity</a><a class="post-meta__tags" href="/tags/%E8%A7%86%E9%A2%91/">视频</a></div><div class="post_share"><div class="social-share" data-image="https://raw.githubusercontent.com/ZeroUltra/MediaLibrary/main/Imgs/202212171811751.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i>打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.jpg" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/wechat.jpg" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/alipay.jpg" alt="alipay"/></a><div class="post-qr-code-desc">alipay</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2020/02-04-2020-2-04-UGUI%E4%BC%98%E5%8C%96/" title="UGUI优化"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/ZeroUltra/MediaLibrary/main/Imgs/202212171812021.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">UGUI优化</div></div></a></div><div class="next-post pull-right"><a href="/2019/12-24-2019-2-24-Unity%E4%B8%AD%E7%9A%84%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D%E4%BB%A5%E5%8F%8A%E5%8D%B8%E8%BD%BD/" title="Unity中的内存分配以及卸载"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/default_cover3.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Unity中的内存分配以及卸载</div></div></a></div></nav><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%A7%86%E9%A2%91%E6%A6%82%E5%BF%B5"><span class="toc-number">1.</span> <span class="toc-text">视频概念</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Unity%E8%A7%86%E9%A2%91%E8%A7%86%E9%A2%91%E6%A0%BC%E5%BC%8F%E9%97%AE%E9%A2%98"><span class="toc-number">2.</span> <span class="toc-text">Unity视频视频格式问题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Unexpected-timestamp-values-detected-This-can-occur-in-H-264-videos-not-encoded-with-the-baseline-profile%E2%80%A6"><span class="toc-number">2.0.1.</span> <span class="toc-text">Unexpected timestamp values detected. This can occur in H.264 videos not encoded with the baseline profile…</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#First-video-frame-not-zero-2-0-083333s-Result-may-be-out-of-sync%E2%80%A6"><span class="toc-number">2.0.2.</span> <span class="toc-text">First video frame not zero: 2 (0.083333s). Result may be out of sync….</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WindowsVideoMedia-error-unhandled-Color-Standard-0-falling-back-to-default-this-may-result-in-rendering-issues"><span class="toc-number">2.0.3.</span> <span class="toc-text">WindowsVideoMedia error unhandled Color Standard: 0 falling back to default this may result in rendering issues</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AudioSampleProvider-buffer-overflow-XXX-frames-discarded"><span class="toc-number">2.0.4.</span> <span class="toc-text">AudioSampleProvider buffer overflow. XXX frames discarded</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%92%AD%E6%94%BE%E9%80%8F%E6%98%8E%E8%A7%86%E9%A2%91"><span class="toc-number">3.</span> <span class="toc-text">播放透明视频</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%A9%E7%94%A8Unity%E8%87%AA%E5%B8%A6%E7%9A%84VideoPlayer%E7%BB%84%E4%BB%B6%E6%92%AD%E6%94%BE%E9%80%8F%E6%98%8E%E8%A7%86%E9%A2%91"><span class="toc-number">3.1.</span> <span class="toc-text">利用Unity自带的VideoPlayer组件播放透明视频</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%B6%E4%BD%9Cwebm%E8%A7%86%E9%A2%91"><span class="toc-number">3.1.1.</span> <span class="toc-text">制作webm视频</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Webm-%E4%B8%8E-VP8"><span class="toc-number">3.1.2.</span> <span class="toc-text">Webm 与 VP8</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%A9%E7%94%A8Avpro-%E6%92%AD%E6%94%BE%E7%BC%96%E7%A0%81%E6%A0%BC%E5%BC%8F%E4%B8%BAHap-alpha%E6%88%96%E8%80%85Hap-Q-alpha-%E7%9A%84-mov%E6%88%96-avi"><span class="toc-number">3.2.</span> <span class="toc-text">利用Avpro 播放编码格式为Hap alpha或者Hap Q alpha 的.mov或.avi</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%BC%E5%87%BAmov%E6%96%87%E4%BB%B6"><span class="toc-number">3.2.1.</span> <span class="toc-text">导出mov文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%B4%E6%8E%A5%E5%9C%A8PR%E6%88%96%E8%80%85Media-Encoder%E4%B8%AD%E5%AF%BC%E5%87%BA"><span class="toc-number">3.2.2.</span> <span class="toc-text">直接在PR或者Media Encoder中导出</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A9%E7%94%A8ffmpeg-%E8%BD%AC%E6%8D%A2"><span class="toc-number">3.2.3.</span> <span class="toc-text">利用ffmpeg 转换</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%A9%E7%94%A8AVpro-%E6%92%AD%E6%94%BE%E9%80%9A%E9%81%93%E5%88%86%E7%A6%BB%E7%9A%84mp4%E8%A7%86%E9%A2%91"><span class="toc-number">3.3.</span> <span class="toc-text">利用AVpro 播放通道分离的mp4视频</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%8F%E6%98%8E%E8%A7%86%E9%A2%91%E5%B7%A5%E5%85%B7"><span class="toc-number">3.4.</span> <span class="toc-text">透明视频工具</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83"><span class="toc-number">3.5.</span> <span class="toc-text">参考</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%A2%98%E5%A4%96%E8%AF%9D"><span class="toc-number">4.</span> <span class="toc-text">题外话</span></a></li></ol></div></div></div></div></main><footer id="footer" style="background-image: url('/img/category_img.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By Roger</div><div class="framework-info"><span>框架 </span><a href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><div class="js-pjax"><script>(() => {
  const initValine = () => {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 's1tU09u71SORzEXhzkOUv8Sj-gzGzoHsz',
      appKey: '3tEBA5yTAbHngderFMTaV0Gx',
      avatar: 'wavatar',
      serverURLs: '',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: false
    }, null))
  }

  const loadValine = async () => {
    if (typeof Valine === 'function') initValine()
    else {
      await getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js')
      initValine()
    }
  }

  if ('Valine' === 'Valine' || !false) {
    if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
    else setTimeout(loadValine, 0)
  } else {
    window.loadOtherComment = loadValine
  }
})()</script></div><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="false"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/assets/unitychan.model.json"},"display":{"position":"right","width":200,"height":400},"mobile":{"show":true},"react":{"opacity":0.8},"log":false});</script></body></html>